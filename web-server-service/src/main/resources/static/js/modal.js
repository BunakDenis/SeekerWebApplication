export class Modal{modalTemplate=document.getElementById("cnt-item-modal-container");cntId=null;constructor(e){this.cntItem=e,this.getCntId(),this.clearModal()}getCntId(e){null!=e&&("TR"==this.cntItem.tagName?cntId=this.cntItem.closest("table").id:cntId=this.cntItem.closest(".sb-cnt-title-container").id)}openModal(){this.modalTemplate.classList.add("show"),this.setModalTitle()}clearModal(){const e=this.modalTemplate.querySelectorAll(".input-field");for(let t=0;t<e.length;t++)e[t].remove()}setModalTitle(){this.modalTemplate.querySelector(".cnt-item-modal-title").textContent="Модальное окно"}closeModal(){this.modalTemplate.classList.remove("show")}}export class ModalImage{modalTemplate=null;imagesModalContainer=null;selectedImageWrapper=null;compactImagesWrapper=null;imagesContainers=[];activeImagesContainerIndex=null;constructor(){this.initModalContainers(),this.initListeners()}open(e){const t=e.findIndex((e=>e.classList.contains("active")));this.activeImagesContainerIndex=t;const i=e[t],o=this.modalTemplate,s=this.imagesModalContainer,a=this.compactImagesWrapper,n=this.selectedImageWrapper,l=i.querySelector("img"),c=i.querySelector("h5");if(l&&n.appendChild(l.cloneNode(!0)),c&&n.appendChild(c.cloneNode(!0)),s.appendChild(n),e.length>1){a.setAttribute("active-image-container-index",t);for(let i=0;i<e.length;i++){const o=document.createElement("div");o.classList.add("photo-compact-container");const s=e[i].querySelector("h5"),n=e[i].querySelector("img");i===t&&o.classList.add("active"),s&&o.appendChild(s),n&&o.appendChild(n),a.appendChild(o)}a.classList.add("show"),s.appendChild(a),this.imagesContainers=Array.from(a.querySelectorAll(".photo-compact-container")),n.classList.add("compact")}else this.imagesContainers=Array.from(n.querySelectorAll(".photo-compact-container"));this.toggleVisibilityShiftPhotoIcons(),o.appendChild(s),o.classList.add("show")}isModalOpen(){return this.modalTemplate.classList.contains("show")}initModalContainers(){const e=document.getElementById("map-photo-modal-wrapper"),t=e.querySelector(".map-photos-modal-container"),i=e.querySelector(".map-photos-compact-wrapper"),o=e.querySelector(".selected-photo-container");this.modalTemplate=e,this.imagesModalContainer=t,this.selectedImageWrapper=o,this.compactImagesWrapper=i}toggleVisibilityShiftPhotoIcons(){const e=this.modalTemplate,t=this.activeImagesContainerIndex,i=this.imagesContainers.length,o=e.querySelector(".bxs-chevron-left"),s=e.querySelector(".bxs-chevron-right");return console.log("index: ",t),console.log("arrayLength: ",i),console.log("prevIcon до проверки: ",o),console.log("nextIcon до проверки: ",s),0===i?(o.classList.add("hidden"),void s.classList.add("hidden")):t===i-1?(o.classList.remove("hidden"),void s.classList.add("hidden")):0===t?(o.classList.add("hidden"),void s.classList.remove("hidden")):(o.classList.remove("hidden"),s.classList.remove("hidden"),console.log("prevIcon после проверки: ",o),void console.log("nextIcon после проверки: ",s))}getActiveImageContainerIndex(){return Number(this.compactImagesWrapper.getAttribute("active-image-container-index"))}getSelectedImageContainerIndex(e){return this.imagesContainers.indexOf(e)}changeActiveImageContainer(){const e=this.imagesContainers,t=this.getActiveImageContainerIndex();console.log("activeImageContainerIndex: ",t);const i=this.activeImagesContainerIndex,o=this.compactImagesWrapper,s=this.selectedImageWrapper;this.clearSelectedMediaContainer();const a=e[t],n=e[i];a.classList.remove("active"),n.classList.add("active");const l=n.querySelector("img"),c=n.querySelector("h5");l&&s.appendChild(l.cloneNode(!0)),c&&s.appendChild(c.cloneNode(!0)),o.setAttribute("active-image-container-index",i)}clearSelectedMediaContainer(){const e=this.selectedImageWrapper;null!=e&&(e.innerHTML="")}clearModal(){this.selectedImageWrapper.innerHTML="",this.compactImagesWrapper.innerHTML="",this.imagesContainers=[],this.activeImagesContainerIndex=null}closePhotoModal(){this.clearModal(),this.selectedImageWrapper.classList.add("compact"),this.compactImagesWrapper.classList.remove("show"),this.modalTemplate.classList.remove("show")}initListeners(){this.modalTemplate.addEventListener("click",(e=>{const t=e.target;if(t.classList.contains("bxs-chevron-left")){const e=this.activeImagesContainerIndex,t=e-1;console.log("bxs-chevron-left"),console.log(`currentIndex: ${e}`),console.log(`selectedIndex: ${t}`),null!=e&&(this.activeImagesContainerIndex=t,this.changeActiveImageContainer(),this.toggleVisibilityShiftPhotoIcons())}if(t.classList.contains("bxs-chevron-right")){const e=this.activeImagesContainerIndex,t=e+1;console.log("bxs-chevron-right"),console.log(`currentIndex: ${e}`),console.log(`selectedIndex: ${t}`),null!=e&&(this.activeImagesContainerIndex=t,this.changeActiveImageContainer(),this.toggleVisibilityShiftPhotoIcons())}if(t.classList.contains("popup-multimedia-item")){const e=t.closest(".photo-compact-container"),i=this.getSelectedImageContainerIndex(e);null!=i&&(this.activeImagesContainerIndex=i,this.changeActiveImageContainer(),this.toggleVisibilityShiftPhotoIcons())}t.getAttribute("id")===String("photo-modal-exit-icon")&&this.closePhotoModal()}))}}